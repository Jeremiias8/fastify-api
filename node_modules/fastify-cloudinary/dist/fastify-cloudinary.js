import { urlToHttpOptions as l } from "url";
import p from "fastify-plugin";
import { v2 as i } from "cloudinary";
const d = p(
  async (n, a) => {
    const e = (s = "") => {
      var r, o;
      const t = l(new URL(s));
      return {
        cloud_name: t.hostname || void 0,
        api_key: (r = t.auth) == null ? void 0 : r.split(":")[0],
        api_secret: (o = t.auth) == null ? void 0 : o.split(":")[1],
        ...a
      };
    };
    i.config(e(a.url)), n.decorate("cloudinary", i);
  },
  {
    fastify: "4.x",
    name: "fastify-cloudinary"
  }
);
export {
  d as default
};
